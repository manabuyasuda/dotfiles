# gh-poi

マージ済みのローカルブランチを安全に一括削除するgh拡張機能。GitHubのプルリクエスト情報をもとにマージ済みかどうかを判定するため、squashマージやリベースマージにも対応する。

## インストール

```bash
gh extension install seachicken/gh-poi
```

`gh/extensions`で自動インストールされる。

## 基本的な使い方

```bash
# マージ済みブランチを対話的に削除
gh poi

# ドライラン（削除対象を確認するだけ）
gh poi --dry-run
```

## 主要オプション

### フラグ

| フラグ | 説明 |
|--------|------|
| `--dry-run` | 実際には削除せず、削除対象のブランチを表示する |
| `--state <closed\|merged>` | 削除対象とするPRの状態を指定する（デフォルトは`merged`） |
| `--debug` | デバッグログを有効にする |

### サブコマンド

| サブコマンド | 説明 |
|--------------|------|
| `lock` | 指定したブランチをロックし、削除対象から除外する |
| `unlock` | ロックを解除し、削除対象に戻す |

## ユースケース

### マージ済みブランチを一括クリーンアップする

```bash
gh poi
```

フィーチャーブランチが溜まったローカルリポジトリで、マージ済みのブランチをまとめて削除する。`git branch -d`と異なり、squashマージされたブランチも正しく検出できる。

### 削除前に対象を確認する

```bash
gh poi --dry-run
```

実際に削除する前に、どのブランチが対象になるかを確認する。

### クローズされたPRのブランチを削除する

```bash
gh poi --state closed
```

マージされずにクローズされたPRのブランチも削除対象にする。不要になった検証用ブランチなどをまとめて整理するときに使う。

### 重要なブランチをロックして保護する

```bash
# developブランチをロックする
gh poi lock develop

# ロックを解除する
gh poi unlock develop
```

`develop`や`staging`など、誤って削除したくないブランチをロックしておく。ロックされたブランチは`gh poi`の削除対象から自動的に除外される。

## 参考リンク

- [GitHub - seachicken/gh-poi](https://github.com/seachicken/gh-poi)
