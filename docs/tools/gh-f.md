# gh-f

fzfを活用してGitHub操作（PR、ブランチ、ログ、ワークフロー等）をインタラクティブにフィルタ・操作できるgh拡張機能。fzfが必要。

## インストール

```bash
gh extension install gennaro-tedesco/gh-f
```

`gh/extensions` で自動インストールされる。

## 主要コマンド

| フラグ | コマンド名 | 説明 |
| --- | --- | --- |
| `-p` | `prs` | オープンなPRの表示・diff・チェックアウト |
| `-b` | `branches` | ブランチのチェックアウト・diff・削除 |
| `-l` | `logs` | コミット履歴の選択・diff表示 |
| `-a` | `adds` | ステージングエリアへの追加（Tabで複数選択） |
| `-r` | `runs` | GitHub Actionsのワークフロー実行結果とログの表示 |
| `-g` | `greps` | リビジョン履歴内のファイルをgrep検索 |
| `-d` | `diffs` | 拡張子を指定してファイルをdiff |
| `-t` | `tags` | バージョンタグのチェックアウト・diff |
| `-R` | `releases` | GitHubリリースの表示・diff |
| `-s` | `search` | 任意のリポジトリのissueを検索 |
| `-m` | `myissue` | 自分が作成したissueを検索 |
| `-k` | `pick` | ブランチ間でファイルをcherry-pick |
| `-e` | `envs` | 現在のプロジェクトのgit config一覧を表示 |

## 共通キーバインド

各コマンドで使えるキーバインドは以下のとおり（コマンドによって対応するキーが異なる）。

| キー | 動作 | 対応コマンド |
| --- | --- | --- |
| `Enter` | チェックアウト/選択/表示 | 全コマンド |
| `Ctrl-D` | diff表示 | `-p`, `-b`, `-l`, `-a`, `-d`, `-t`, `-R` |
| `Ctrl-V` | 詳細表示（PRの内容、コミットパッチ等） | `-p`, `-l`, `-t`, `-R` |
| `Ctrl-X` | 削除/チェックアウト（変更の取り消し） | `-b`, `-d` |
| `Ctrl-S` | 3ドットdiff（`<branch>...HEAD`） | `-b` |
| `Tab` | 複数選択 | `-a`, `-k` |

## 基本的な使い方

```bash
# PRをfzfで一覧表示
gh f -p

# ブランチをfzfで一覧表示
gh f -b

# コミット履歴をfzfで表示
gh f -l

# GitHub Actionsのワークフロー実行結果を表示
gh f -r

# ファイルをインタラクティブにステージング
gh f -a
```

## ユースケース

### PRをあいまい検索してチェックアウトする

```bash
gh f -p
```

fzfの絞り込みUIでオープンなPRを検索し、Enterでブランチをチェックアウトできる。Ctrl-Dでdiff、Ctrl-Vでブラウザ表示に切り替えられる。

### ブランチを選択して操作する

```bash
gh f -b
```

ローカル・リモートブランチをfzfで一覧表示し、チェックアウト・diff確認・削除をキーバインドで操作する。リモートブランチを選択した場合は自動でトラッキングブランチが作成される。Ctrl-Sで`<branch>...HEAD`の3ドットdiffも確認できる。

### コミット履歴から特定のコミットを探す

```bash
# 全コミット履歴から検索
gh f -l

# 特定ファイルのコミット履歴に絞り込む
gh f -l src/index.ts
```

fzfでコミットを絞り込み、Enterでチェックアウト、Ctrl-Dで現在のブランチとのdiff、Ctrl-Vでコミットパッチを表示する。

### ファイルをインタラクティブにステージングする

```bash
gh f -a
```

変更のあるファイルがfzfで一覧表示される。Tabで複数ファイルを選択してからEnterでまとめてステージングできる。Ctrl-Dで選択ファイルのdiffを事前確認できるので、意図しない変更を含めずに済む。

### リビジョン履歴内をgrep検索する

```bash
gh f -g
```

パターンの入力を求められ、過去のリビジョン履歴から該当パターンを含むファイルを検索できる。削除済みコードの調査に役立つ。

### GitHub Actionsのワークフロー結果を確認する

```bash
gh f -r
```

ワークフローの実行結果を一覧表示し、Enterで選択した実行のログを検索・表示する。CIの失敗原因を素早く特定できる。

### タグやリリースを比較する

```bash
# バージョンタグの一覧表示・diff
gh f -t

# GitHubリリースの一覧表示・diff
gh f -R
```

Enterでタグ/リリースをdetached HEADでチェックアウト、Ctrl-Dで現在のブランチとのdiffを確認できる。バージョン間の変更点を把握する際に便利。

### 他ブランチからファイルを取り込む

```bash
gh f -k
```

ブランチとファイルの指定を対話的に行い、Tabで複数ファイルを選択してcherry-pickできる。両方のブランチに存在するファイルのみが表示される。

### issueを横断検索する

```bash
# 任意のリポジトリのissueを検索
gh f -s

# 自分が作成したissueを検索
gh f -m
```

リポジトリ名とissueタイトルの入力を求められ、Enterで選択したissueの詳細を表示する。

## 参考リンク

- [GitHub - gennaro-tedesco/gh-f](https://github.com/gennaro-tedesco/gh-f)
