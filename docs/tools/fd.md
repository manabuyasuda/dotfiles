# fd

findコマンドの現代的な代替ツール。Rust製で高速。デフォルトで`.gitignore`を尊重し、正規表現ベースのマッチングをする。出力もカラー付きで見やすく、`find`の冗長な記法が不要になる。

## インストール

```bash
brew install fd
```

`Brewfile`で管理。

## 基本的な使い方

```bash
# ファイル名であいまい検索
fd readme

# 正規表現で検索
fd "\.test\.ts$"

# glob パターンで検索
fd -g "*.test.ts"

# 拡張子で絞り込み
fd -e tsx

# ディレクトリのみ検索
fd --type d

# 隠しファイルも含めて検索
fd -H "\.env"
```

## 主要オプション

### 検索パターン

| オプション | 説明 |
|---|---|
| `-g, --glob` | globパターンで検索（デフォルトは正規表現） |
| `-F, --fixed-strings` | パターンをリテラル文字列として扱う |
| `-s, --case-sensitive` | 大文字小文字を区別する |
| `-i, --ignore-case` | 大文字小文字を区別しない |
| `-p, --full-path` | フルパスに対してパターンマッチする |
| `--and <pattern>` | 追加の検索条件（AND検索） |

### フィルタリング

| オプション | 説明 |
|---|---|
| `-e, --extension <ext>` | 拡張子で絞り込み（複数指定可） |
| `-t, --type <type>` | 種別で絞り込み（`f`=ファイル, `d`=ディレクトリー, `l`=シンボリックリンク, `x`=実行可能, `e`=空） |
| `-S, --size <size>` | ファイルサイズで絞り込み（例: `+1m`, `-100k`） |
| `-d, --max-depth <N>` | ディレクトリーの探索深度を制限 |
| `--exact-depth <N>` | 指定深度のみ表示 |
| `-E, --exclude <pattern>` | globパターンで除外（複数指定可） |
| `--changed-within <date\|dur>` | 指定日時・期間以降に変更されたファイル（例: `2weeks`, `1d`） |
| `--changed-before <date\|dur>` | 指定日時・期間以前に変更されたファイル |
| `-o, --owner <user:group>` | 所有者・グループで絞り込み |

### 無視ルール

| オプション | 説明 |
|---|---|
| `-H, --hidden` | 隠しファイル・ディレクトリーも検索対象にする |
| `-I, --no-ignore` | `.gitignore`等の無視ルールを無効にする |
| `-u, --unrestricted` | `-H -I`のエイリアス（1回で隠しファイル＋ignore無効、2回で全制限解除） |

### コマンド実行

| オプション | 説明 |
|---|---|
| `-x, --exec <cmd>` | 各結果に対してコマンドを並列実行 |
| `-X, --exec-batch <cmd>` | 全結果をまとめて一度にコマンド実行 |

`-x`/`-X`で使えるプレースホルダー:

| プレースホルダー | 展開先 |
|---|---|
| `{}` | フルパス |
| `{/}` | ファイル名 |
| `{//}` | 親ディレクトリー |
| `{.}` | 拡張子を除いたパス |
| `{/.}` | 拡張子を除いたファイル名 |

### 出力制御

| オプション | 説明 |
|---|---|
| `-a, --absolute-path` | 絶対パスで表示 |
| `-l, --list-details` | `ls -l`形式で詳細表示 |
| `-0, --print0` | null文字区切りで出力（xargs向け） |
| `--max-results <N>` | 結果件数を制限 |
| `-1` | 最初の1件だけ表示して終了 |
| `-q, --quiet` | 出力なし、マッチがあればexit 0（スクリプト向け） |

## ユースケース

### テストファイルを一覧する

```bash
fd "\.test\.ts$"
```

`find . -name "*.test.ts"`と同等だが、より簡潔で高速。

### 特定の拡張子のファイルに一括処理を実行する

```bash
fd -e tsx -x prettier -w
```

全`.tsx`ファイルを見つけて、それぞれに`prettier`を並列実行する。

### ファイルを一括リネームする

```bash
fd -e .jpeg -x mv {} {.}.jpg
```

`.jpeg`ファイルを`.jpg`にリネームする。プレースホルダー`{.}`で拡張子を除いたパスを参照できる。

### 大きなファイルを見つける

```bash
fd -S +10m
```

10MB以上のファイルを検索する。`-S +100k`や`-S -1k`のようにサイズ条件を指定できる。

### 最近変更されたファイルを確認する

```bash
fd --changed-within 1d
```

直近24時間以内に変更されたファイルを表示する。`2weeks`、`30min`、`2024-01-01`のような指定も可能。

### 特定のディレクトリーを除外して検索する

```bash
fd -e ts -E node_modules -E dist
```

`-E`で除外パターンを複数指定できる。`.gitignore`でカバーされないビルド成果物の除外に使える。

### 空のファイルやディレクトリーを見つける

```bash
fd --type empty
```

空のファイルとディレクトリーを検出する。`fd -te -td`でディレクトリーのみ、`fd -te -tf`でファイルのみに絞れる。

### fzfと組み合わせてインタラクティブに検索する

```bash
fd --type f | fzf
```

fdの高速なファイル列挙とfzfのあいまい検索を組み合わせた、強力なファイル検索ワークフロー。

### ファイルの存在チェックをスクリプトで使う

```bash
if fd -q "\.env\.local$"; then
  echo ".env.local が存在します"
fi
```

`-q`は出力なしでexit codeだけを返す。シェルスクリプトの条件分岐に使える。

## 参考リンク

- [GitHub - sharkdp/fd](https://github.com/sharkdp/fd)
